# -*- coding: utf-8 -*-
from __future__ import absolute_import
import os
import sys
import json

from sqlalchemy import distinct

# add up one level dir into sys path
sys.path.append(os.path.abspath(os.path.dirname(os.path.dirname(__file__))))
os.environ['DJANGO_SETTINGS_MODULE'] = 'luckyplatform.settings'

from lxml import etree

from luckycommon.model import orm
from luckycommon.order.model.order import Area


text = u'''
<optgroup label="基隆市"><option value="200仁愛區" isIsland="false">200仁愛區</option><option value="201信義區" isIsland="false">201信義區</option><option value="202中正區" isIsland="false">202中正區</option><option value="203中山區" isIsland="false">203中山區</option><option value="204安樂區" isIsland="false">204安樂區</option><option value="205暖暖區" isIsland="false">205暖暖區</option><option value="206七堵區" isIsland="false">206七堵區</option></optgroup><optgroup label="台北市"><option value="100中正區" isIsland="false">100中正區</option><option value="103大同區" isIsland="false">103大同區</option><option value="104中山區" isIsland="false">104中山區</option><option value="105松山區" isIsland="false">105松山區</option><option value="106大安區" isIsland="false">106大安區</option><option value="108萬華區" isIsland="false">108萬華區</option><option value="110信義區" isIsland="false">110信義區</option><option value="111士林區" isIsland="false">111士林區</option><option value="112北投區" isIsland="false">112北投區</option><option value="114內湖區" isIsland="false">114內湖區</option><option value="115南港區" isIsland="false">115南港區</option><option value="116文山區" isIsland="false">116文山區</option></optgroup><optgroup label="新北市"><option value="207萬里區" isIsland="false">207萬里區</option><option value="208金山區" isIsland="false">208金山區</option><option value="220板橋區" isIsland="false">220板橋區</option><option value="221汐止區" isIsland="false">221汐止區</option><option value="222深坑區" isIsland="false">222深坑區</option><option value="223石碇區" isIsland="false">223石碇區</option><option value="224瑞芳區" isIsland="false">224瑞芳區</option><option value="226平溪區" isIsland="false">226平溪區</option><option value="227雙溪區" isIsland="false">227雙溪區</option><option value="228貢寮區" isIsland="false">228貢寮區</option><option value="231新店區" isIsland="false">231新店區</option><option value="232坪林區" isIsland="false">232坪林區</option><option value="233烏來區" isIsland="false">233烏來區</option><option value="234永和區" isIsland="false">234永和區</option><option value="235中和區" isIsland="false">235中和區</option><option value="236土城區" isIsland="false">236土城區</option><option value="237三峽區" isIsland="false">237三峽區</option><option value="238樹林區" isIsland="false">238樹林區</option><option value="239鶯歌區" isIsland="false">239鶯歌區</option><option value="241三重區" isIsland="false">241三重區</option><option value="242新莊區" isIsland="false">242新莊區</option><option value="243泰山區" isIsland="false">243泰山區</option><option value="244林口區" isIsland="false">244林口區</option><option value="247蘆洲區" isIsland="false">247蘆洲區</option><option value="248五股區" isIsland="false">248五股區</option><option value="249八里區" isIsland="false">249八里區</option><option value="251淡水區" isIsland="false">251淡水區</option><option value="252三芝區" isIsland="false">252三芝區</option><option value="253石門區" isIsland="false">253石門區</option></optgroup><optgroup label="宜蘭縣"><option value="260宜蘭市" isIsland="false">260宜蘭市</option><option value="261頭城鎮" isIsland="false">261頭城鎮</option><option value="262礁溪鄉" isIsland="false">262礁溪鄉</option><option value="263壯圍鄉" isIsland="false">263壯圍鄉</option><option value="264員山鄉" isIsland="false">264員山鄉</option><option value="265羅東鎮" isIsland="false">265羅東鎮</option><option value="266三星鄉" isIsland="false">266三星鄉</option><option value="267大同鄉" isIsland="false">267大同鄉</option><option value="268五結鄉" isIsland="false">268五結鄉</option><option value="269冬山鄉" isIsland="false">269冬山鄉</option><option value="270蘇澳鎮" isIsland="false">270蘇澳鎮</option><option value="272南澳鄉" isIsland="false">272南澳鄉</option></optgroup><optgroup label="桃園市"><option value="320中壢區" isIsland="false">320中壢區</option><option value="324平鎮區" isIsland="false">324平鎮區</option><option value="325龍潭區" isIsland="false">325龍潭區</option><option value="326楊梅區" isIsland="false">326楊梅區</option><option value="327新屋區" isIsland="false">327新屋區</option><option value="328觀音區" isIsland="false">328觀音區</option><option value="330桃園區" isIsland="false">330桃園區</option><option value="333龜山區" isIsland="false">333龜山區</option><option value="334八德區" isIsland="false">334八德區</option><option value="335大溪區" isIsland="false">335大溪區</option><option value="336復興區" isIsland="false">336復興區</option><option value="337大園區" isIsland="false">337大園區</option><option value="338蘆竹區" isIsland="false">338蘆竹區</option></optgroup><optgroup label="新竹市"><option value="300新竹市" isIsland="false">300新竹市</option></optgroup><optgroup label="新竹縣"><option value="302竹北市" isIsland="false">302竹北市</option><option value="303湖口鄉" isIsland="false">303湖口鄉</option><option value="304新豐鄉" isIsland="false">304新豐鄉</option><option value="305新埔鎮" isIsland="false">305新埔鎮</option><option value="306關西鎮" isIsland="false">306關西鎮</option><option value="307芎林鄉" isIsland="false">307芎林鄉</option><option value="308寶山鄉" isIsland="false">308寶山鄉</option><option value="310竹東鎮" isIsland="false">310竹東鎮</option><option value="311五峰鄉" isIsland="false">311五峰鄉</option><option value="312橫山鄉" isIsland="false">312橫山鄉</option><option value="313尖石鄉" isIsland="false">313尖石鄉</option><option value="314北埔鄉" isIsland="false">314北埔鄉</option><option value="315峨眉鄉" isIsland="false">315峨眉鄉</option></optgroup><optgroup label="苗栗縣"><option value="350竹南鎮" isIsland="false">350竹南鎮</option><option value="351頭份鎮" isIsland="false">351頭份鎮</option><option value="352三灣鄉" isIsland="false">352三灣鄉</option><option value="353南庄鄉" isIsland="false">353南庄鄉</option><option value="354獅潭鄉" isIsland="false">354獅潭鄉</option><option value="356後龍鎮" isIsland="false">356後龍鎮</option><option value="357通霄鎮" isIsland="false">357通霄鎮</option><option value="358苑裡鎮" isIsland="false">358苑裡鎮</option><option value="360苗栗市" isIsland="false">360苗栗市</option><option value="361造橋鄉" isIsland="false">361造橋鄉</option><option value="362頭屋鄉" isIsland="false">362頭屋鄉</option><option value="363公館鄉" isIsland="false">363公館鄉</option><option value="364大湖鄉" isIsland="false">364大湖鄉</option><option value="365泰安鄉" isIsland="false">365泰安鄉</option><option value="366銅鑼鄉" isIsland="false">366銅鑼鄉</option><option value="367三義鄉" isIsland="false">367三義鄉</option><option value="368西湖鄉" isIsland="false">368西湖鄉</option><option value="369卓蘭鎮" isIsland="false">369卓蘭鎮</option></optgroup><optgroup label="台中市"><option value="400中區" isIsland="false">400中區</option><option value="401東區" isIsland="false">401東區</option><option value="402南區" isIsland="false">402南區</option><option value="403西區" isIsland="false">403西區</option><option value="404北區" isIsland="false">404北區</option><option value="406北屯區" isIsland="false">406北屯區</option><option value="407西屯區" isIsland="false">407西屯區</option><option value="408南屯區" isIsland="false">408南屯區</option><option value="411太平區" isIsland="false">411太平區</option><option value="412大里區" isIsland="false">412大里區</option><option value="413霧峰區" isIsland="false">413霧峰區</option><option value="414烏日區" isIsland="false">414烏日區</option><option value="420豐原區" isIsland="false">420豐原區</option><option value="421后里區" isIsland="false">421后里區</option><option value="422石岡區" isIsland="false">422石岡區</option><option value="423東勢區" isIsland="false">423東勢區</option><option value="424和平區" isIsland="false">424和平區</option><option value="426新社區" isIsland="false">426新社區</option><option value="427潭子區" isIsland="false">427潭子區</option><option value="428大雅區" isIsland="false">428大雅區</option><option value="429神岡區" isIsland="false">429神岡區</option><option value="432大肚區" isIsland="false">432大肚區</option><option value="433沙鹿區" isIsland="false">433沙鹿區</option><option value="434龍井區" isIsland="false">434龍井區</option><option value="435梧棲區" isIsland="false">435梧棲區</option><option value="436清水區" isIsland="false">436清水區</option><option value="437大甲區" isIsland="false">437大甲區</option><option value="438外埔區" isIsland="false">438外埔區</option><option value="439大安區" isIsland="false">439大安區</option></optgroup><optgroup label="彰化縣"><option value="500彰化市" isIsland="false">500彰化市</option><option value="502芬園鄉" isIsland="false">502芬園鄉</option><option value="503花壇鄉" isIsland="false">503花壇鄉</option><option value="504秀水鄉" isIsland="false">504秀水鄉</option><option value="505鹿港鎮" isIsland="false">505鹿港鎮</option><option value="506福興鄉" isIsland="false">506福興鄉</option><option value="507線西鄉" isIsland="false">507線西鄉</option><option value="508和美鎮" isIsland="false">508和美鎮</option><option value="509伸港鄉" isIsland="false">509伸港鄉</option><option value="510員林鎮" isIsland="false">510員林鎮</option><option value="511社頭鄉" isIsland="false">511社頭鄉</option><option value="512永靖鄉" isIsland="false">512永靖鄉</option><option value="513埔心鄉" isIsland="false">513埔心鄉</option><option value="514溪湖鎮" isIsland="false">514溪湖鎮</option><option value="515大村鄉" isIsland="false">515大村鄉</option><option value="516埔鹽鄉" isIsland="false">516埔鹽鄉</option><option value="520田中鎮" isIsland="false">520田中鎮</option><option value="521北斗鎮" isIsland="false">521北斗鎮</option><option value="522田尾鄉" isIsland="false">522田尾鄉</option><option value="523埤頭鄉" isIsland="false">523埤頭鄉</option><option value="524溪州鄉" isIsland="false">524溪州鄉</option><option value="525竹塘鄉" isIsland="false">525竹塘鄉</option><option value="526二林鎮" isIsland="false">526二林鎮</option><option value="527大城鄉" isIsland="false">527大城鄉</option><option value="528芳苑鄉" isIsland="false">528芳苑鄉</option><option value="530二水鄉" isIsland="false">530二水鄉</option></optgroup><optgroup label="南投縣"><option value="540南投市" isIsland="false">540南投市</option><option value="541中寮鄉" isIsland="false">541中寮鄉</option><option value="542草屯鎮" isIsland="false">542草屯鎮</option><option value="544國姓鄉" isIsland="false">544國姓鄉</option><option value="545埔里鎮" isIsland="false">545埔里鎮</option><option value="546仁愛鄉" isIsland="false">546仁愛鄉</option><option value="551名間鄉" isIsland="false">551名間鄉</option><option value="552集集鎮" isIsland="false">552集集鎮</option><option value="553水里鄉" isIsland="false">553水里鄉</option><option value="555魚池鄉" isIsland="false">555魚池鄉</option><option value="556信義鄉" isIsland="false">556信義鄉</option><option value="557竹山鎮" isIsland="false">557竹山鎮</option><option value="558鹿谷鄉" isIsland="false">558鹿谷鄉</option></optgroup><optgroup label="雲林縣"><option value="630斗南鎮" isIsland="false">630斗南鎮</option><option value="631大埤鄉" isIsland="false">631大埤鄉</option><option value="632虎尾鎮" isIsland="false">632虎尾鎮</option><option value="633土庫鎮" isIsland="false">633土庫鎮</option><option value="634褒忠鄉" isIsland="false">634褒忠鄉</option><option value="635東勢鄉" isIsland="false">635東勢鄉</option><option value="636臺西鄉" isIsland="false">636臺西鄉</option><option value="637崙背鄉" isIsland="false">637崙背鄉</option><option value="638麥寮鄉" isIsland="false">638麥寮鄉</option><option value="640斗六市" isIsland="false">640斗六市</option><option value="643林內鄉" isIsland="false">643林內鄉</option><option value="646古坑鄉" isIsland="false">646古坑鄉</option><option value="647莿桐鄉" isIsland="false">647莿桐鄉</option><option value="648西螺鎮" isIsland="false">648西螺鎮</option><option value="649二崙鄉" isIsland="false">649二崙鄉</option><option value="651北港鎮" isIsland="false">651北港鎮</option><option value="652水林鄉" isIsland="false">652水林鄉</option><option value="653口湖鄉" isIsland="false">653口湖鄉</option><option value="654四湖鄉" isIsland="false">654四湖鄉</option><option value="655元長鄉" isIsland="false">655元長鄉</option></optgroup><optgroup label="嘉義市"><option value="600嘉義市" isIsland="false">600嘉義市</option></optgroup><optgroup label="嘉義縣"><option value="602番路鄉" isIsland="false">602番路鄉</option><option value="603梅山鄉" isIsland="false">603梅山鄉</option><option value="604竹崎鄉" isIsland="false">604竹崎鄉</option><option value="605阿里山鄉" isIsland="false">605阿里山鄉</option><option value="606中埔鄉" isIsland="false">606中埔鄉</option><option value="607大埔鄉" isIsland="false">607大埔鄉</option><option value="608水上鄉" isIsland="false">608水上鄉</option><option value="611鹿草鄉" isIsland="false">611鹿草鄉</option><option value="612太保市" isIsland="false">612太保市</option><option value="613朴子市" isIsland="false">613朴子市</option><option value="614東石鄉" isIsland="false">614東石鄉</option><option value="615六腳鄉" isIsland="false">615六腳鄉</option><option value="616新港鄉" isIsland="false">616新港鄉</option><option value="621民雄鄉" isIsland="false">621民雄鄉</option><option value="622大林鎮" isIsland="false">622大林鎮</option><option value="623溪口鄉" isIsland="false">623溪口鄉</option><option value="624義竹鄉" isIsland="false">624義竹鄉</option><option value="625布袋鎮" isIsland="false">625布袋鎮</option></optgroup><optgroup label="台南市"><option value="700中西區" isIsland="false">700中西區</option><option value="701東區" isIsland="false">701東區</option><option value="702南區" isIsland="false">702南區</option><option value="704北區" isIsland="false">704北區</option><option value="708安平區" isIsland="false">708安平區</option><option value="709安南區" isIsland="false">709安南區</option><option value="710永康區" isIsland="false">710永康區</option><option value="711歸仁區" isIsland="false">711歸仁區</option><option value="712新化區" isIsland="false">712新化區</option><option value="713左鎮區" isIsland="false">713左鎮區</option><option value="714玉井區" isIsland="false">714玉井區</option><option value="715楠西區" isIsland="false">715楠西區</option><option value="716南化區" isIsland="false">716南化區</option><option value="717仁德區" isIsland="false">717仁德區</option><option value="718關廟區" isIsland="false">718關廟區</option><option value="719龍崎區" isIsland="false">719龍崎區</option><option value="720官田區" isIsland="false">720官田區</option><option value="721麻豆區" isIsland="false">721麻豆區</option><option value="722佳里區" isIsland="false">722佳里區</option><option value="723西港區" isIsland="false">723西港區</option><option value="724七股區" isIsland="false">724七股區</option><option value="725將軍區" isIsland="false">725將軍區</option><option value="726學甲區" isIsland="false">726學甲區</option><option value="727北門區" isIsland="false">727北門區</option><option value="730新營區" isIsland="false">730新營區</option><option value="731後壁區" isIsland="false">731後壁區</option><option value="732白河區" isIsland="false">732白河區</option><option value="733東山區" isIsland="false">733東山區</option><option value="734六甲區" isIsland="false">734六甲區</option><option value="735下營區" isIsland="false">735下營區</option><option value="736柳營區" isIsland="false">736柳營區</option><option value="737鹽水區" isIsland="false">737鹽水區</option><option value="741善化區" isIsland="false">741善化區</option><option value="742大內區" isIsland="false">742大內區</option><option value="743山上區" isIsland="false">743山上區</option><option value="744新市區" isIsland="false">744新市區</option><option value="745安定區" isIsland="false">745安定區</option></optgroup><optgroup label="高雄市"><option value="800新興區" isIsland="false">800新興區</option><option value="801前金區" isIsland="false">801前金區</option><option value="802苓雅區" isIsland="false">802苓雅區</option><option value="803鹽埕區" isIsland="false">803鹽埕區</option><option value="804鼓山區" isIsland="false">804鼓山區</option><option value="805旗津區" isIsland="false">805旗津區</option><option value="806前鎮區" isIsland="false">806前鎮區</option><option value="807三民區" isIsland="false">807三民區</option><option value="811楠梓區" isIsland="false">811楠梓區</option><option value="812小港區" isIsland="false">812小港區</option><option value="813左營區" isIsland="false">813左營區</option><option value="814仁武區" isIsland="false">814仁武區</option><option value="815大社區" isIsland="false">815大社區</option><option value="820岡山區" isIsland="false">820岡山區</option><option value="821路竹區" isIsland="false">821路竹區</option><option value="822阿蓮區" isIsland="false">822阿蓮區</option><option value="823田寮區" isIsland="false">823田寮區</option><option value="824燕巢區" isIsland="false">824燕巢區</option><option value="825橋頭區" isIsland="false">825橋頭區</option><option value="826梓官區" isIsland="false">826梓官區</option><option value="827彌陀區" isIsland="false">827彌陀區</option><option value="828永安區" isIsland="false">828永安區</option><option value="829湖內區" isIsland="false">829湖內區</option><option value="830鳳山區" isIsland="false">830鳳山區</option><option value="831大寮區" isIsland="false">831大寮區</option><option value="832林園區" isIsland="false">832林園區</option><option value="833鳥松區" isIsland="false">833鳥松區</option><option value="840大樹區" isIsland="false">840大樹區</option><option value="842旗山區" isIsland="false">842旗山區</option><option value="843美濃區" isIsland="false">843美濃區</option><option value="844六龜區" isIsland="false">844六龜區</option><option value="845內門區" isIsland="false">845內門區</option><option value="846杉林區" isIsland="false">846杉林區</option><option value="847甲仙區" isIsland="false">847甲仙區</option><option value="848桃源區" isIsland="false">848桃源區</option><option value="849那瑪夏區" isIsland="false">849那瑪夏區</option><option value="851茂林區" isIsland="false">851茂林區</option><option value="852茄萣區" isIsland="false">852茄萣區</option></optgroup><optgroup label="屏東縣"><option value="900屏東市" isIsland="false">900屏東市</option><option value="901三地門鄉" isIsland="false">901三地門鄉</option><option value="902霧臺鄉" isIsland="false">902霧臺鄉</option><option value="903瑪家鄉" isIsland="false">903瑪家鄉</option><option value="904九如鄉" isIsland="false">904九如鄉</option><option value="905里港鄉" isIsland="false">905里港鄉</option><option value="906高樹鄉" isIsland="false">906高樹鄉</option><option value="907鹽埔鄉" isIsland="false">907鹽埔鄉</option><option value="908長治鄉" isIsland="false">908長治鄉</option><option value="909麟洛鄉" isIsland="false">909麟洛鄉</option><option value="911竹田鄉" isIsland="false">911竹田鄉</option><option value="912內埔鄉" isIsland="false">912內埔鄉</option><option value="913萬丹鄉" isIsland="false">913萬丹鄉</option><option value="920潮州鎮" isIsland="false">920潮州鎮</option><option value="921泰武鄉" isIsland="false">921泰武鄉</option><option value="922來義鄉" isIsland="false">922來義鄉</option><option value="923萬巒鄉" isIsland="false">923萬巒鄉</option><option value="924崁頂鄉" isIsland="false">924崁頂鄉</option><option value="925新埤鄉" isIsland="false">925新埤鄉</option><option value="926南州鄉" isIsland="false">926南州鄉</option><option value="927林邊鄉" isIsland="false">927林邊鄉</option><option value="928東港鎮" isIsland="false">928東港鎮</option><option value="931佳冬鄉" isIsland="false">931佳冬鄉</option><option value="932新園鄉" isIsland="false">932新園鄉</option><option value="940枋寮鄉" isIsland="false">940枋寮鄉</option><option value="941枋山鄉" isIsland="false">941枋山鄉</option><option value="942春日鄉" isIsland="false">942春日鄉</option><option value="943獅子鄉" isIsland="false">943獅子鄉</option><option value="944車城鄉" isIsland="false">944車城鄉</option><option value="945牡丹鄉" isIsland="false">945牡丹鄉</option><option value="946恆春鎮" isIsland="false">946恆春鎮</option><option value="947滿州鄉" isIsland="false">947滿州鄉</option><option value="929琉球鄉" isIsland="true">929琉球鄉</option></optgroup><optgroup label="花蓮縣"><option value="970花蓮市" isIsland="false">970花蓮市</option><option value="971新城鄉" isIsland="false">971新城鄉</option><option value="972秀林鄉" isIsland="false">972秀林鄉</option><option value="973吉安鄉" isIsland="false">973吉安鄉</option><option value="974壽豐鄉" isIsland="false">974壽豐鄉</option><option value="975鳳林鎮" isIsland="false">975鳳林鎮</option><option value="976光復鄉" isIsland="false">976光復鄉</option><option value="977豐濱鄉" isIsland="false">977豐濱鄉</option><option value="978瑞穗鄉" isIsland="false">978瑞穗鄉</option><option value="979萬榮鄉" isIsland="false">979萬榮鄉</option><option value="981玉里鎮" isIsland="false">981玉里鎮</option><option value="982卓溪鄉" isIsland="false">982卓溪鄉</option><option value="983富里鄉" isIsland="false">983富里鄉</option></optgroup><optgroup label="台東縣"><option value="950台東市" isIsland="false">950台東市</option><option value="953延平鄉" isIsland="false">953延平鄉</option><option value="954卑南鄉" isIsland="false">954卑南鄉</option><option value="955鹿野鄉" isIsland="false">955鹿野鄉</option><option value="956關山鎮" isIsland="false">956關山鎮</option><option value="957海端鄉" isIsland="false">957海端鄉</option><option value="958池上鄉" isIsland="false">958池上鄉</option><option value="959東河鄉" isIsland="false">959東河鄉</option><option value="961成功鎮" isIsland="false">961成功鎮</option><option value="962長濱鄉" isIsland="false">962長濱鄉</option><option value="963太麻里鄉" isIsland="false">963太麻里鄉</option><option value="964金峰鄉" isIsland="false">964金峰鄉</option><option value="965大武鄉" isIsland="false">965大武鄉</option><option value="966達仁鄉" isIsland="false">966達仁鄉</option><option value="951綠島鄉" isIsland="true">951綠島鄉</option></optgroup><optgroup label="澎湖縣"><option value="880馬公市" isIsland="true">880馬公市</option><option value="881西嶼鄉" isIsland="true">881西嶼鄉</option><option value="884白沙鄉" isIsland="true">884白沙鄉</option><option value="885湖西鄉" isIsland="true">885湖西鄉</option></optgroup><optgroup label="金門縣"><option value="890金沙鎮" isIsland="true">890金沙鎮</option><option value="891金湖鎮" isIsland="true">891金湖鎮</option><option value="892金寧鄉" isIsland="true">892金寧鄉</option><option value="893金城鎮" isIsland="true">893金城鎮</option><option value="894烈嶼鄉" isIsland="true">894烈嶼鄉</option></optgroup><optgroup label="連江縣"><option value="209南竿鄉" isIsland="true">209南竿鄉</option><option value="210北竿鄉" isIsland="true">210北竿鄉</option><option value="211莒光鄉" isIsland="true">211莒光鄉</option><option value="212東引鄉" isIsland="true">212東引鄉</option></optgroup>
'''
html = etree.HTML(text)
result = html.xpath('//optgroup/@label')
print result
count = 1
for r in result:
    parent = Area()
    parent.id = count
    parent.name = r.encode('utf-8')
    parent.full_name = parent.name
    parent.parent_id = 0
    parent.save()
    count += 1
    children_path = "//optgroup[@label='%s']/option" % r
    children = html.xpath(children_path)
    cc = 1
    for child in children:
        print '\t'+child.text
        c = Area()
        c.id = '%d00%d' % (parent.id, cc) 
        c.name = child.text[3:]
        c.full_name = r + child.text[3:]
        c.parent_id = parent.id
        c.save()
        cc += 1
